---
title: ç ´è§£ Android åº”ç”¨ä¼šå‘˜é€»è¾‘
date: 2025-06-03
categories: ["å¼€å‘å·¥å…·"]
tags: ["Android"]  # è¿™ä¼šè¢«è‡ªåŠ¨å¡«å……ä¸ºå¯¹åº”çš„æ ‡ç­¾
---
> âš ï¸ **å…è´£å£°æ˜ï¼šæœ¬æ•™ç¨‹ä»…ä¾›å­¦ä¹  Android å®‰å…¨å’Œé€†å‘å·¥ç¨‹çŸ¥è¯†ï¼Œè¯·å‹¿ç”¨äºå•†ä¸šç ´è§£æˆ–ä»»ä½•è¿æ³•è¡Œä¸ºã€‚è‹¥ç”¨äºéæ³•ç›®çš„ï¼Œåæœè‡ªè´Ÿï¼**

## ğŸ§° å·¥å…·å‡†å¤‡

| å·¥å…·               | è¯´æ˜                   | ä¸‹è½½åœ°å€                                                                                                            |
| ---------------- | -------------------- | --------------------------------------------------------------------------------------------------------------- |
| ğŸ”¹ Java JDKï¼ˆ8+ï¼‰  | ç”¨äºè¿è¡Œ apktool å’Œç­¾å APK | [Oracle JDK](https://www.oracle.com/java/technologies/javase-downloads.html) æˆ– [OpenJDK](https://jdk.java.net/) |
| ğŸ”¹ Apktool       | ç”¨äºåç¼–è¯‘ / å›ç¼–è¯‘ APK      | [Apktool å®˜ç½‘](https://ibotpeaches.github.io/Apktool/)                                                            |
| ğŸ”¹ Frida-dexdump | ç”¨äºåŠ¨æ€è„±å£³               | [GitHub - frida-dexdump](https://github.com/hluwa/frida-dexdump)                                                |
| ğŸ”¹ Jadx GUI      | å°† APK è½¬æ¢ä¸º Java æºç     | [Jadx GitHub](https://github.com/skylot/jadx)                                                                   |
| ğŸ”¹ ADB å·¥å…·        | å®‰è£… APK åˆ° Android æ‰‹æœº  | [Platform Tools](https://developer.android.com/studio/releases/platform-tools)                                  |


## ğŸ”§ ä¸€ã€ç¯å¢ƒé…ç½®

### âœ… é…ç½® Java JDK ç¯å¢ƒå˜é‡ï¼ˆä»¥ JDK 17 ä¸ºä¾‹ï¼‰

1. å®‰è£… JDKï¼Œå‡è®¾è·¯å¾„ä¸ºï¼š`C:\Program Files\Java\jdk-17`
2. æ‰“å¼€ç³»ç»Ÿç¯å¢ƒå˜é‡è®¾ç½®ï¼š

    * æ–°å»ºç³»ç»Ÿå˜é‡ `JAVA_HOME`ï¼Œå€¼ä¸º JDK è·¯å¾„ï¼š

      ```
      JAVA_HOME = C:\Program Files\Java\jdk-17
      ```
    * ç¼–è¾‘ `Path` å˜é‡ï¼Œæ·»åŠ ï¼š

      ```
      %JAVA_HOME%\bin
      ```
3. éªŒè¯æ˜¯å¦é…ç½®æˆåŠŸï¼š

```cmd
java -version
javac -version
```

### âœ… é…ç½® apktool ä½¿ç”¨ï¼ˆæ¨è CLI æ–¹å¼ï¼‰

1. ä¸‹è½½ `apktool_2.xx.jar` ï¼Œæ”¾åˆ°å¦‚ `F:\AndroidTools\apktool\` ä¸­ã€‚
2. æ–°å»º `apktool.bat` å†…å®¹å¦‚ä¸‹ï¼š

```bat
@echo off
java -jar "%~dp0apktool_2.9.3.jar" %*
```

3. æ·»åŠ åˆ°ç³»ç»Ÿ Path ç¯å¢ƒå˜é‡ï¼š

```bat
F:\AndroidTools\apktool\
```

4. éªŒè¯æ˜¯å¦æˆåŠŸï¼š

```cmd
apktool
```


### âœ… ä½¿ç”¨ Frida è¿›è¡Œè„±å£³

1. å®‰è£… fridaï¼š

```bash
pip3 install frida frida-tools frida-dexdump
```

2. ä¸‹è½½ `frida-server`ï¼ˆç‰ˆæœ¬æ ¹æ®ç›®æ ‡ Android ç³»ç»Ÿå’Œæ¶æ„é€‰æ‹©ï¼‰ï¼Œä¾‹å¦‚ `frida-server-17.0.7-android-x86_64.xz`

3. è§£å‹å¹¶æ”¾å…¥ MuMu æ¨¡æ‹Ÿå™¨ shell ç›®å½•ï¼ˆä¾‹å¦‚ï¼š`F:\MuMu Player 12\shell`ï¼‰ï¼Œä¸ `adb.exe` åŒç›®å½•ã€‚

4. å¯åŠ¨MuMuæ¨¡æ‹Ÿå™¨ï¼Œè¿æ¥ adb(æˆ‘è¿™ä¸ªæ¨¡æ‹Ÿå™¨çš„ç«¯å£æ˜¯ 7555,ä¸åŒæ¨¡æ‹Ÿå™¨å¯èƒ½ä¸ä¸€æ ·)ï¼š

```bash
adb connect 127.0.0.1:7555
```

5. è®¾ç½®ä¸º root æƒé™ï¼š

```bash
adb root
```

6. æ¨é€å¹¶è®¾ç½®æ‰§è¡Œæƒé™ï¼š

å°†ä¸‹è½½çš„frida-server-16.0.11-android-x86_64è§£å‹åæ”¾åˆ°mumuæ¨¡æ‹Ÿå™¨shellç›®å½•ä¸‹ï¼Œä¸adbåŒä¸€ç›®å½•ï¼Œæ³¨æ„ä¸€å®šæ˜¯è§£å‹åçš„

```bash
adb push frida-server-17.0.7-android-x86_64 /data/local/tmp/
adb shell chmod 755 /data/local/tmp/frida-server-17.0.7-android-x86_64
```

7. å¯åŠ¨ frida-serverï¼ˆæ³¨æ„ä½¿ç”¨ç®¡ç†å‘˜æƒé™çš„ CMDï¼‰ï¼š

```bash
adb shell /data/local/tmp/frida-server-17.0.7-android-x86_64 &
```

è‹¥æç¤º `Permission denied`ï¼Œè¯´æ˜æ¨¡æ‹Ÿå™¨æœª rootï¼Œå¯å°è¯•ä½¿ç”¨å¯ä»¥rootçš„æ¨¡æ‹Ÿå™¨

8. è·å–å½“å‰è¿è¡Œä¸­çš„åº”ç”¨çš„åŒ…åï¼š

```bash
adb shell dumpsys window | findstr mCurrentFocus
```

## ğŸ” äºŒã€ä½¿ç”¨ Jadx GUI åˆ†æ VIP é€»è¾‘

1. å¯åŠ¨ `jadx-gui.exe`ï¼Œæ‰“å¼€ APK æ–‡ä»¶ï¼ˆå¦‚ `app.apk`ï¼‰
2. æœç´¢ä»¥ä¸‹å…³é”®è¯ï¼š

   ```
   isVip
   getIsVipVideo
   isPaid
   money
   pay_type
   ```
3. æ‰¾åˆ°æ ¸å¿ƒ Java æ–¹æ³•ï¼Œä¾‹å¦‚ï¼š

```java
public boolean getIsMoneyVideo() {
    return StringUtils.INSTANCE.isBiggerThan0(this.money);
}

public boolean getIsVipVideo() {
    return !getIsMoneyVideo() && TextUtils.equals(this.pay_type, "vip");
}
```

## ğŸ›  ä¸‰ã€ä½¿ç”¨ apktool ä¿®æ”¹ smali å®ç°

### 1. åç¼–è¯‘ APKï¼š

```bash
apktool d app.apk -o app_src
```

### 2. ä¿®æ”¹ smali æ–‡ä»¶ï¼š

æ–‡ä»¶å¯èƒ½åœ¨å¦‚ä¸‹è·¯å¾„ï¼š

```
app_src/smali*/com/xxx/xxx/bean/VideoItemBean.smali
```

å°† `getIsVipVideo()` æ–¹æ³•æ›¿æ¢ä¸ºï¼š

```smali
.method public getIsVipVideo()Z
    .locals 1
    const/4 v0, 0x1
    return v0
.end method
```

æ­¤ä¿®æ”¹è¡¨ç¤ºè¯¥æ–¹æ³•æ’å®šè¿”å› `true`ï¼Œå§‹ç»ˆè§†ä¸º VIPã€‚


## ğŸ§± å››ã€é‡æ–°æ‰“åŒ… APK

```bash
apktool b app_src -o modified_app.apk
```

## ğŸ” äº”ã€ç”Ÿæˆç­¾åå¯†é’¥å¹¶ç­¾å APK

### 1. ç”Ÿæˆ keystoreï¼ˆä»…éœ€ä¸€æ¬¡ï¼‰

```bash
keytool -genkeypair -alias my-key-alias -keyalg RSA -keysize 2048 -validity 10000 \
 -keystore my-release-key.keystore -storepass 123456 -keypass 123456 \
 -dname "CN=Test, OU=Dev, O=Dev, L=City, ST=State, C=CN"
```

### 2. ä½¿ç”¨ `jarsigner` ç­¾å APK

```bash
jarsigner -verbose -sigalg SHA256withRSA -digestalg SHA-256 \
 -keystore my-release-key.keystore -storepass 123456 \
 modified_app.apk my-key-alias
```

## ğŸš€ å…­ã€å®‰è£…å¹¶æµ‹è¯•

ç¡®ä¿å¼€å¯ USB è°ƒè¯•å¹¶è¿æ¥è®¾å¤‡ï¼š

```bash
adb install -r modified_app.apk
```

æ‰“å¼€ Appï¼ŒéªŒè¯ VIP åŠŸèƒ½æ˜¯å¦ç ´è§£æˆåŠŸã€‚

## ğŸ§© å¸¸è§é—®é¢˜ FAQ

| é—®é¢˜                      | è§£å†³æ–¹æ¡ˆ                                          |
| ----------------------- | --------------------------------------------- |
| å®‰è£…å¤±è´¥ï¼šç­¾åä¸åˆæ³•              | ä½¿ç”¨ `jarsigner` é‡æ–°ç­¾å APK                       |
| æç¤º SHA1 ç®—æ³•è¢«ç¦ç”¨           | æ”¹ç”¨ `SHA256withRSA` ç­¾åç®—æ³•                       |
| æ‰¾ä¸åˆ°ä¿®æ”¹æ–¹æ³•                 | ç”¨ jadx çš„â€œè·³è½¬åˆ°å®šä¹‰â€åŠŸèƒ½ç²¾ç¡®å®šä½ï¼Œæˆ–æœç´¢ smali ç±»åç²¾ç¡®ä¿®æ”¹        |
| ä¿®æ”¹æ— æ•ˆ                    | æ£€æŸ¥æ˜¯å¦ä¿®æ”¹äº†æ­£ç¡® smali æ–‡ä»¶ï¼Œæ˜¯å¦é‡æ–°æ‰“åŒ…ã€ç­¾åå’Œå®‰è£…æˆåŠŸ             |
| frida æ— æ³•æ³¨å…¥æˆ–æŠ¥ SELinux é”™è¯¯ | å°è¯• root è®¾å¤‡æˆ–æ›´æ¢æ¨¡æ‹Ÿå™¨ï¼›ä¹Ÿå¯ç”¨ Magisk é…ç½®ä¸º permissive æ¨¡å¼ |
