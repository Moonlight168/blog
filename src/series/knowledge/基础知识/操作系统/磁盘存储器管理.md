---
title: 磁盘存储器管理
order: 10
---

# 第10章 磁盘存储器管理

## 磁盘的结构与访问时间

### 磁盘结构
* **盘片**：存储数据的圆形金属片
* **磁头**：读写数据的传感器
* **磁道**：磁盘表面的同心圆
* **扇区**：磁道上的最小存储单元
* **柱面**：所有盘片上相同磁道的集合

### 访问时间组成
* **寻道时间（Ts）**：磁头移动到目标磁道的时间
* **旋转延迟（Tr）**：等待目标扇区旋转到磁头下方的时间
* **传输时间（Tt）**：数据传输时间
* **总访问时间 = 寻道时间 + 旋转延迟 + 传输时间**

## 磁盘调度算法

磁盘调度是为了减少寻道时间，提高磁盘I/O性能。

* **先来先服务（FCFS）**：按请求到达顺序服务
  * 优点：公平，算法简单
  * 缺点：寻道时间长，效率低
* **最短寻道时间优先（SSTF）**：选择距离当前磁头最近的请求
  * 优点：平均寻道时间较短
  * 缺点：可能造成饥饿现象
* **扫描算法（SCAN）**：磁头沿一个方向移动，处理沿途所有请求
  * 优点：避免饥饿，响应时间均匀
  * 缺点：两端请求等待时间长
* **循环扫描算法（C-SCAN）**：沿一个方向扫描，到达另一端后快速返回起点
  * 优点：响应时间更均匀
* **LOOK算法**：改进的SCAN，磁头只移动到最远请求位置
* **C-LOOK算法**：改进的C-SCAN，磁头只移动到最远请求位置

## 磁盘管理

### 磁盘格式化
* **低级格式化**：在磁盘上建立扇区标记，设置扇区结构
* **高级格式化**：建立文件系统结构（如FAT、NTFS、ext4）

### 磁盘空间管理
* **位示图**：用二进制位表示磁盘块使用状态
* **空闲块链表**：链接所有空闲块
* **成组链接法**：将空闲块分组成链，提高效率

### 磁盘错误处理
* **坏块处理**：标记坏块，使用备用块替换
* **写回策略**：数据写入时机控制
* **事务保护**：保证数据一致性

## RAID技术

**RAID**（Redundant Array of Independent Disks）通过多磁盘并行工作提高性能和可靠性。

* **RAID 0（条带化）**：数据分块存储在多个磁盘上，并行读写
  * 优点：性能高，无冗余
  * 缺点：无容错能力
* **RAID 1（镜像）**：数据完全复制到多个磁盘
  * 优点：可靠性高，读性能好
  * 缺点：存储利用率低
* **RAID 5**：分布式奇偶校验，平衡性能和可靠性
* **RAID 6**：双重分布式奇偶校验，可容忍两个磁盘故障
* **RAID 10**：结合RAID 0和RAID 1的优点

## 固态硬盘（SSD）管理

### SSD特点
* **随机访问速度快**：无机械寻道延迟
* **擦写寿命有限**：每个块有擦写次数限制
* **写放大效应**：写入数据量可能大于实际数据量

### SSD管理策略
* **磨损均衡**：均匀分配擦写操作
* **垃圾回收**：清理无效数据
* **TRIM命令**：提前通知SSD哪些数据已被删除
* **写放大控制**：减少不必要的写入操作