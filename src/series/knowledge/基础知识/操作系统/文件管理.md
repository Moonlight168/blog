---
title: 文件管理
order: 9
---

# 第9章 文件管理

## 文件系统基础

**文件**是具有文件名的一组相关元素的集合。文件在外部存储器上的存储方式称为**文件的物理结构**。

## 文件的物理结构

* **连续结构**：
  * 文件在磁盘上连续存放
  * 优点：读写速度快，支持随机访问
  * 缺点：会产生外部碎片，空间利用率低
* **链接结构**：
  * 隐式链接：目录项只记录起始地址，每块末尾存下一块地址
  * 显式链接：将所有磁盘块的链接指针统一存放在文件分配表(FAT)中
* **索引结构**：
  * 为每个文件建立索引表，记录所有磁盘块地址
  * 支持随机访问，查找效率高
  * 适用于大文件

## 文件的逻辑结构

* **无结构文件（流式文件）**：字符流，如文本文件、二进制文件
* **记录式文件**：由记录组成，如数据库文件
* **索引文件**：建立索引表，支持快速查找

## 目录管理

* **单级目录**：所有文件在一个目录下，简单但不支持重名
* **二级目录**：分为主目录和用户目录，解决重名问题
* **树形目录**：支持多级目录，便于层次管理
* **无环图目录**：支持文件共享，但需要引用计数和垃圾回收
* **通用图目录**：允许环路存在，查找需要特殊处理

## 文件存储空间管理

* **空闲表法**：记录所有空闲块号，适用于连续分配
* **空闲链表法**：将空闲块链接成链表，插入删除方便
* **位示图法**：用二进制位表示空闲块状态，空间利用率高
* **成组链接法**：将空闲块分组，适合大文件管理

## 文件保护与安全

* **访问类型**：读、写、执行、删除等
* **访问控制**：
  * 访问控制列表（ACL）：为每个文件记录各用户的访问权限
  * 能力表：为每个用户记录可访问的文件
* **文件保护机制**：
  * 用户身份验证
  * 权限检查
  * 审计日志

## 文件操作

* **基本操作**：创建、删除、打开、关闭、读写
* **目录操作**：创建、删除、移动、遍历
* **文件属性操作**：获取、设置文件属性
* **文件系统操作**：格式化、挂载、卸载