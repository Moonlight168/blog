---
order: 1
title: 项目介绍
dir:
    text: 淘票票
    icon: /assets/icon/淘票票icon.png
    order: 2
---
# 淘票票（Taopiaopiao）-高并发分布式票务系统

[![License](https://img.shields.io/badge/License-Apache%202.0-blue.svg)](https://opensource.org/licenses/Apache-2.0)  ![Java](https://img.shields.io/badge/Java-17-orange)  ![Spring Boot](https://img.shields.io/badge/Spring%20Boot-3.2.x-brightgreen)  ![Build](https://img.shields.io/badge/build-Maven-blue)

> 一个基于 Spring Cloud Alibaba 构建的高并发票务系统，专注于演唱会/大型活动的高并发抢票场景。

---

## 🚀 项目简介

**淘票票（Taopiaopiao）** 是一个高并发分布式票务系统，聚焦于 **演唱会/大型活动抢票** 等秒杀场景，重点解决 **高并发下的库存一致性、性能瓶颈与系统可用性** 问题。

系统设计目标：

* **高性能**：通过缓存预热、异步削峰、读写分离等手段，支撑 **万级 QPS** 的并发抢票请求
* **高一致性**：使用 Redis Lua 脚本与分布式锁保证库存原子扣减，结合消息队列实现订单与库存最终一致
* **高可用**：利用 Sentinel 限流熔断与 Kafka 异步削峰，确保系统在流量洪峰下稳定运行
* **可扩展性**：模块化微服务架构 + 分库分表 + Docker 部署，支持灵活扩展与快速上线

该项目不仅是一个票务系统，更是一次 **高并发分布式架构的综合实战**，涵盖缓存、消息队列、数据库分片、分布式锁、限流熔断等核心技术栈。

---

## 🔍 项目界面预览

| 页面 | 示例截图                                  |
| ----- | ------------------------------------- |
| 登录界面  | ![login](imges/页面预览图/login.png)  |
| 主页面   | ![home](imges/页面预览图/home.png)    |
| 分类列表  | ![category](imges/页面预览图/categories.png) |
| 票务详情页 | ![ticket](imges/页面预览图/detail.png) |
| 支付页面  | ![pay](imges/页面预览图/pay.png)      |

---

## 🧭 项目架构图

| 图示                                                                        |
|-------------------------------------------------------------------------- |
| ![业务大纲](../imges/淘票票/业务大纲.png)                         |
| ![组织架构图](../imges/淘票票/组织架构图.png)                      |                
| ![项目架构图动态](../imges/淘票票/项目架构图.gif)  |

## ✨ 淘票票项目技术亮点一览

### Ⅰ. 核心技术架构与治理

| 维度 | 技术/方案 | 亮点与优势 |
| :--- | :--- | :--- |
| **微服务架构** | **Spring Cloud Alibaba 全家桶** | 基于 SpringCloud 体系构建分布式系统，快速实现服务注册、配置管理与流量治理。|
| **服务治理** | **Nacos + Sentinel** | Nacos 实现服务注册与发现、统一配置管理；Sentinel 实现熔断降级、系统自适应限流。|
| **API 网关** | **Spring Cloud Gateway** | 统一 API 入口，实现鉴权、路由转发、全局限流、请求日志等功能，保障后端服务安全。|
| **数据层架构** | **ShardingSphere 分库分表** | 针对订单、用户等核心表进行分库分表（如按用户ID或订单ID），有效解决海量数据存储瓶长颈与查询性能问题。|
| **ID 生成** | **分布式 ID (雪花算法优化)** | 采用优化的雪花算法，保证全局唯一且趋势递增的 ID，满足分库分表键值与高性能要求。|

### Ⅱ. 高并发与性能优化（万级 QPS 核心保障）

| 维度 | 技术/方案 | 亮点与优势 |
| :--- | :--- | :--- |
| **极致性能优化** | **订单生成四版本演进** | 从 V1 直写 DB 到 **V4 Redis Lua 原子扣减 + 异步 Kafka 落库 + Redisson 锁**，性能提升约 **15 倍**，达到 **12000 QPS**。|
| **库存一致性** | **Redis Lua 脚本原子操作** | 使用 Lua 脚本将“检查库存”和“扣减库存”封装为单个原子命令执行，彻底杜绝超卖。|
| **多级缓存体系** | **Caffeine (L1) + Redis (L2)** | **本地缓存**（Caffeine）承担热点数据第一层压力，**分布式缓存**（Redis）提供共享数据，有效降低网络IO和数据库压力。|
| **缓存安全** | **防穿透、击穿、雪崩** | **布隆过滤器** 结合缓存空值防穿透；**数据预热** + **热点数据永不失效** 防击穿/雪崩。|
| **分布式锁** | **Redisson 高性能分布式锁** | 采用 Redisson 实现了基于 Redis 的分布式锁，具备自动续期（看门狗）、防止死锁等特性，保障购票过程并发安全。|

### Ⅲ. 核心中间件高级应用

| 维度 | 技术/方案 | 亮点与优势 |
| :--- | :--- | :--- |
| **异步处理与削峰** | **Kafka 消息队列** | 核心购票流程采用 Kafka 异步处理订单落库、库存补偿等，平滑流量洪峰，保障系统高可用。|
| **业务一致性** | **Redis 延迟队列 (ZSet)** | 精准控制订单支付超时关闭逻辑，超时未支付则释放库存，保证资源最大化利用。|
| **数据流处理** | **Redis Stream** | 用于实现消息队列特性，支持消费组、消息持久化和消费追踪，用于日志或关键操作的可靠记录。|
| **数据搜索** | **Elasticsearch (ES)** | 为票务/场次提供高性能全文检索服务，支持复杂条件筛选和快速响应。|
| **可观测性** | **ELK Stack (日志) + Prometheus/Grafana (监控)** | 统一日志采集、存储与查询；实时监控 JVM、业务指标、延迟、错误率，实现高效故障排查和预警。|

### Ⅳ. 核心业务与工程实践

| 维度 | 技术/方案 | 亮点与优势 |
| :--- | :--- | :--- |
| **数据一致性** | **延迟双删/消息队列补偿** | 结合使用**延迟双删**策略和**消息队列**保证最终一致性，解决高并发下缓存与数据库的瞬时不一致问题。|
| **线程池优化** | **定制化线程池** | 基于业务场景定制 IO 密集型和 CPU 密集型线程池，并集成 **TraceId**（MDC），便于跨线程的日志链路追踪。|
| **幂等性保障** | **防重复提交机制** | 采用 AOP 注解 + Token/分布式锁，实现订单创建、支付等核心接口的幂等性控制，防止用户重复操作。|
| **读写分离优化** | **订单查询分库设计** | 针对订单历史查询进行分库设计，避免用户高频查询引发的读扩散问题影响核心业务数据库。|
| **组件化设计** | **SpringBoot Starter** | 封装可复用的业务组件，基于 SpringBoot 自动装配机制，提高代码复用率和开发效率。|

---

## 🔧 快速运行

### 本地环境依赖

* JDK 17
* Maven 3.8+
* MySQL 8+
* Redis 6+
* Kafka 3+
* Nacos 2.x

### 启动步骤

```bash
# clone 仓库
git clone https://github.com/java-up-up/taopiaopiao.git
cd taopiaopiao

# 构建
mvn clean package -DskipTests

# 启动依赖服务（推荐使用 Docker Compose）
docker-compose up -d

# 启动应用服务
cd taopiaopiao-server
mvn spring-boot:run
```

### Swagger 接口文档

访问：[http://localhost:8080/swagger-ui/index.html](http://localhost:8080/swagger-ui/index.html)

---

## 📈 性能优化实践

本地 JMeter 压测（1w 并发）结果：

| 版本                    | QPS    | 平均延迟   | 超卖情况 |
| --------------------- | ------ | ------ | ---- |
| V1（直写 DB）             | ~800   | 500ms+ | 严重   |
| V2（Redis 预扣）          | ~3500  | 120ms  | 少量   |
| V3（Redis Lua + Kafka） | ~12000 | 40ms   | 无    |
| V4（加锁优化）              | ~11000 | 50ms   | 无    |

> ⚡ 从直写 DB 到异步 Kafka，性能提升约 15 倍。

---


✨ **淘票票（Taopiaopiao）——让高并发系统设计更优雅。**
