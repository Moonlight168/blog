---
title: "技术选型"
icon: /assets/icon/选型.png
order: 2
---

# FlowMind 技术选型文档

## 一、项目总体概述

### 1.1 项目简介

**FlowMind** 是一个基于 **云原生 + 大模型（LLM）** 的智能审批工作流编排平台。
系统结合 **Flowable** 轻量级开源 BPMN 工作流引擎、**Spring Cloud Alibaba 微服务架构** 与 **LLM 智能决策 Agent**，用于跨部门预算、资源申请等业务流程的自动化与智能化。

### 1.2 系统目标

| 目标     | 说明                                 |
| ------ | ---------------------------------- |
| 智能化审批  | 通过 LLM 自动分析申请文本、提取字段、智能路由          |
| 分布式一致性 | Saga 模式 + 事务消息确保多服务操作一致            |
| 云原生高可用 | Kubernetes + Helm 实现高可靠部署          |
| 持续集成   | Jenkins Pipeline 自动化构建、测试、部署       |
| 可观测性   | SkyWalking + Prometheus 实现全链路追踪与监控 |

---

## 二、架构设计选型

### 2.1 系统架构模式

| 模块层次  | 技术选型                                  | 说明             |
| ----- | ------------------------------------- | -------------- |
| 架构风格  | **微服务架构（Spring Cloud Alibaba）**       | 各服务独立部署与扩展     |
| 工作流引擎 | **Flowable**                          | 轻量级开源 BPMN 工作流引擎 |
| 智能决策层 | **FastAPI + LangChain + OpenAI API**  | 智能审批与文本解析      |
| 通信方式  | **REST / gRPC / RocketMQ**            | 异步通信与跨语言调用     |
| 部署环境  | **Kubernetes + Helm + Docker**        | 云原生弹性伸缩        |
| 数据一致性 | **Saga 模式 + RocketMQ 事务消息**           | 实现最终一致性        |
| 持续集成  | **Jenkins Pipeline + GitHub Webhook** | 自动构建发布         |

---

## 三、后端技术选型

### 3.1 语言与运行环境

| 技术          | 版本    | 说明          |
| ----------- | ----- | ----------- |
| Java        | 18.0.2    | 主体业务开发语言 |
| Python      | 3.10+ | 智能 Agent 模块 |
| Maven       | 3.9+  | Java 构建工具   |

---

### 3.2 Spring Cloud Alibaba 微服务体系

| 模块      | 组件                           | 作用          |
| ------- | ---------------------------- | ----------- |
| 服务注册与配置 | **Nacos v2.3.2**             | 注册中心 + 配置中心 |
| 网关层     | **Spring Cloud Gateway**     | 路由转发与统一认证入口 |
| 熔断与限流   | **Sentinel**                 | 流量控制与保护机制   |
| 服务间通信   | **OpenFeign + LoadBalancer** | 服务调用与负载均衡   |
| 分布式事务   | **Seata + Saga 模式**          | 跨服务事务补偿     |
| 消息队列    | **RocketMQ 5.2.0**           | 异步通信与事件驱动   |
| 链路追踪    | **SkyWalking 9.7.0**         | 分布式调用链监控    |

---

### 3.3 业务微服务模块

| 模块                   | 技术栈                        | 职责          |
| -------------------- | -------------------------- | ----------- |
| flowmind-workflow     | Spring Boot + Flowable     | 审批处理逻辑、流程调用 |
| flowmind-application  | Spring Boot + MyBatis-Plus | 表单与业务模板管理    |
| flowmind-content      | Spring Boot + JPA          | 文件与资源管理      |
| flowmind-notification | Spring Boot + Mail/WebSocket | 消息通知、实时推送    |
| flowmind-auth         | Spring Security + JWT      | 认证授权与用户管理    |
| flowmind-gateway      | Spring Cloud Gateway       | API网关与流量控制    |
| flowmind-monitor      | Spring Boot + SkyWalking   | 监控审计与日志管理    |
| flowmind-api          | 公共API模块                 | DTO与Feign接口定义   |
| flowmind-common       | 通用工具模块                 | 工具类、异常、结果封装  |

---

## 四、智能 Agent 技术选型（Python）

| 模块     | 技术                             | 功能             |
| ------ | ------------------------------ | -------------- |
| 框架     | FastAPI                        | 轻量高性能 API 服务   |
| LLM 框架 | LangChain                      | Prompt 管理与链式推理 |
| 大模型    | OpenAI GPT / Claude / 本地 LLaMA | 智能文本分析与审批辅助    |
| 向量存储   | FAISS / Chroma                 | 语义匹配与上下文记忆     |
| 接口通信   | gRPC + REST                    | 与 Java 微服务双向通信 |
| 日志监控   | Loguru + Prometheus Exporter   | 性能指标与错误监控      |

---

## 五、数据与缓存层选型

| 模块       | 技术               | 说明          |
| -------- | ---------------- | ----------- |
| 主存储      | PostgreSQL 16-alpine | 结构化业务数据     |
| 缓存       | Redis 7-alpine    | 会话与高频查询缓存   |
| 文件存储（可选） | MinIO / OSS      | 审批附件与文件存储   |
| 搜索服务（可选） | Elasticsearch    | 审批历史查询与检索优化 |

---

## 六、消息与异步通信选型

| 技术                    | 作用                    |
| --------------------- | --------------------- |
| RocketMQ              | 核心异步事件驱动（申请事件、审批状态更新） |
| Flowable Task Service | BPMN 工作流任务分发与执行    |
| WebSocket / Kafka（可选） | 实时通知与多 Agent 通信       |

---

## 七、DevOps 与 CI/CD

### 7.1 持续集成与部署

| 工具             | 用途          |
| -------------- | ----------- |
| Jenkins        | 自动化构建与发布流水线 |
| GitHub Webhook | 提交触发构建      |
| Docker         | 服务容器化       |
| Helm           | K8s 应用打包与部署 |
| ArgoCD（可选）     | GitOps 持续交付 |

### 7.2 Jenkinsfile 示例结构

```groovy
pipeline {
  agent any
  stages {
    stage('Build') {
      steps {
        sh 'mvn clean package -DskipTests'
      }
    }
    stage('Docker Build & Push') {
      steps {
        sh 'docker build -t registry/flowmind-approval:latest .'
        sh 'docker push registry/flowmind-approval:latest'
      }
    }
    stage('Deploy to K8s') {
      steps {
        sh 'helm upgrade --install flowmind ./k8s/chart -n flowmind'
      }
    }
  }
}
```

---

## 八、监控与可观测性

| 模块   | 技术                | 说明          |
| ---- | ----------------- | ----------- |
| 指标采集 | Prometheus v2.45.0 | 性能指标与健康状态   |
| 链路追踪 | SkyWalking 9.7.0   | 服务调用与耗时监控   |
| 可视化  | Grafana 10.1.2     | 图表与告警面板     |
| 日志聚合 | ELK / Loki         | 集中式日志分析     |
| 运行管理 | Flowable UI        | BPMN 流程实例监控 |

---

## 九、安全与认证

| 模块   | 技术                     | 功能        |
| ---- | ---------------------- | --------- |
| 鉴权框架 | Spring Security + JWT  | 用户登录、角色权限 |
| 接口安全 | HTTPS + Gateway Filter | 请求加密与访问控制 |
| 数据脱敏 | AOP + 自定义注解            | 关键数据脱敏处理  |
| 日志审计 | Logback + TraceId      | 审批操作可追溯   |

---

## 十、高可用与容灾设计

| 层级  | 方案                | 说明                 |
| --- | ----------------- | ------------------ |
| 应用层 | K8s 副本集 + HPA     | 自动伸缩与负载均衡          |
| 数据层 | PostgreSQL 主从复制   | 容灾备份               |
| 缓存层 | Redis Sentinel 集群 | 高可用缓存              |
| 消息层 | RocketMQ 集群       | Broker 冗余与重试机制     |
| 工作流 | Flowable 集群     | 流程实例持久化与高可用    |

---

## 十一、性能与稳定性优化

* 使用 **连接池（HikariCP）** 优化数据库性能
* 对 LLM Agent 调用增加 **请求缓存与批量推理**
* 利用 **Redis Stream** 实现消息缓冲
* 通过 **Sentinel 热点规则** 动态限流
* 使用 **JMeter / K6** 进行压测与自动回归验证

---

## 十二、结语

FlowMind 的技术选型兼顾了 **智能化、可扩展性与高可用性**，
在企业级审批场景下可实现“人机协同决策 + 自动化流转 + 端到端可观测”。
未来可拓展为通用的智能工作流平台，为各类企业自动化审批系统提供标准化参考架构。